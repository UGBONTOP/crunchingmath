<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <title>Core System</title>
    <style>
        body { background: #000; color: #111; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        .u-i { background: #080808; padding: 25px; border-radius: 12px; border: 1px solid #111; margin-bottom: 20px; transition: 0.5s; opacity: 0.03; }
        .u-i:hover { opacity: 1; border-color: #222; }
        input { background: #000; border: 1px solid #222; color: #0f0; padding: 12px; width: 240px; border-radius: 6px; outline: none; }
        button { background: #111; color: #444; border: 1px solid #222; padding: 12px 24px; border-radius: 6px; cursor: pointer; }
        #v-stage { width: 854px; height: 480px; background: #000; border: 1px solid #050505; position: relative; }
    </style>
</head>
<body>

    <div class="u-i">
        <label for="v_input" style="display:none;">Source</label>
        <input type="text" id="v_input" name="v_input" placeholder="Video ID">
        <button id="v_btn">Initialize</button>
    </div>

    <div id="v-stage"></div>

    <script>
        (function() {
            const btn = document.getElementById('v_btn');
            const stage = document.getElementById('v-stage');

            // The URL shards: "https://www.youtube-nocookie.com/embed/"
            const _SHARDS = [104, 116, 116, 112, 115, 58, 47, 47, 119, 119, 119, 46, 121, 111, 117, 116, 117, 98, 101, 45, 110, 111, 99, 111, 111, 107, 105, 101, 46, 99, 111, 109, 47, 101, 109, 98, 101, 100, 47];

            btn.addEventListener('click', () => {
                const val = document.getElementById('v_input').value.trim();
                const id = val.length > 11 ? val.match(/[a-zA-Z0-9_-]{11}/)[0] : val;
                
                if (id && id.length === 11) {
                    // Reset stage to avoid "Shadow root already exists" error
                    stage.innerHTML = '';
                    const host = document.createElement('div');
                    host.style.cssText = 'width:100%;height:100%;';
                    stage.appendChild(host);
                    
                    assemble(id, host);
                }
            });

            function assemble(vid, host) {
                const root = host.attachShadow({ mode: 'closed' });

                // We use <object> instead of <iframe>. 
                // Many Chromebook extensions ignore <object type="text/html">.
                const obj = document.createElement('object');
                obj.setAttribute('type', 'text/html');
                obj.style.cssText = 'width:100%;height:100%;border:none;';
                
                // This handshake is vital to fix Error 153
                obj.setAttribute('referrerpolicy', 'no-referrer-when-downgrade');
                
                root.appendChild(obj);

                // CHARACTER TYPING: We push the URL one character at a time.
                // The full string never exists in your JavaScript source code.
                let ptr = "";
                for(let i=0; i<_SHARDS.length; i++) {
                    ptr += String.fromCharCode(_SHARDS[i]);
                    // We update the data attribute incrementally
                    obj.data = ptr;
                }
                
                // Final piece: The ID + params
                obj.data = ptr + vid + "?autoplay=1&modestbranding=1&rel=0";

                // Block extensions from sniffing the load event
                obj.addEventListener('load', (e) => e.stopImmediatePropagation(), true);
            }
        })();
    </script>
</body>
</html>