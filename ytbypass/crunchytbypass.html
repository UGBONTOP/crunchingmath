<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stealth Portal</title>
    <style>
        body { background: #050505; color: #444; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        .ui-hub { background: #111; padding: 20px; border-radius: 8px; border: 1px solid #222; margin-bottom: 20px; }
        input { background: #000; border: 1px solid #333; color: #0f0; padding: 10px; width: 220px; border-radius: 4px; outline: none; }
        button { background: #222; color: #eee; border: 1px solid #333; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        #player-container { width: 854px; height: 480px; background: #000; border: 1px solid #111; position: relative; }
    </style>
</head>
<body>

    <div class="ui-hub">
        <label for="v_input" style="display:none;">Source</label>
        <input type="text" id="v_input" name="v_input" placeholder="YouTube ID">
        <button id="v_btn">Initialize</button>
    </div>

    <div id="player-container"></div>

    <script>
        (function() {
            // "https://www.youtube-nocookie.com/embed/" encoded in Base64
            const _B64_BASE = "aHR0cHM6Ly93d3cueW91dHViZS1ub2Nvb2tpZS5jb20vZW1iZWQv";
            
            const btn = document.getElementById('v_btn');
            const container = document.getElementById('player-container');

            btn.addEventListener('click', () => {
                const val = document.getElementById('v_input').value;
                // Simple regex to grab ID from a link or take the raw 11 chars
                const id = val.match(/([a-zA-Z0-9_-]{11})/) ? val.match(/([a-zA-Z0-9_-]{11})/)[0] : null;
                
                if (id) {
                    launch(id);
                }
            });

            function launch(vid) {
                container.innerHTML = '';
                
                // Create the Shadow Root - Chromebook extensions can't query inside a 'closed' root
                const shadow = container.attachShadow({ mode: 'closed' });

                // Use an <embed> tag. Extensions focus on <iframe>; <embed> is often overlooked.
                const player = document.createElement('embed');
                
                // Decode the base and attach the ID
                const target = atob(_B64_BASE) + vid + "?autoplay=1&rel=0&modestbranding=1";

                player.setAttribute('type', 'text/html');
                player.setAttribute('src', target);
                player.style.width = '100%';
                player.style.height = '100%';
                
                // Forces the browser to send the identity YouTube needs for 'Error 153'
                player.setAttribute('referrerpolicy', 'no-referrer-when-downgrade');

                shadow.appendChild(player);
            }
        })();
    </script>
</body>
</html>